name: Go

jobs:
    build:
        name: Build
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: golangci-lint
      uses: golangci/golangci-lint-action@v1
      with:
          version: v1.30
          run:
              concurrency: 4
          linters:
              enable:
                  - golint
                  - govet
              disable-all: true

      steps:
          - name: Set up Go 1.x
      uses: actions/setup-go@v2
      with:
          go-version: ^1.13
      id: go


    - name: Check out code into the Go module directory
      uses: actions/checkout@v2

    - name: Get dependencies
      run: |
          go get -v -t -d ./...
          export GO111MODULE=on
          export GOBIN=$(go env GOPATH)

    - name: Test
      run: make tests

    - name: Build
      run: make     
